{
  "paragraphs":[
    {
      "text":"%md\n# Analyzing network intrusion dataset with Python and Spark\n## Original work By [Saptak Sen](http://saptak.in) / Updated to Eskimo by Jerome Kehrli [www.niceideas.ch](http://www.niceideas.ch)\n---\n\n## Introduction\n\nIn this tutorial we are going to analyze a network intrusion events dataset with **Python** in a Zeppelin Notebook. The Zeppelin Notebook provides an easy and interactive surface for data scientists to explore data through data processing engines like **Hive** and **Spark**. Hive and Spark in turn benefit from robust managability, resource allocation policies, security and scalability running on a YARN managed infrasturcture.\n\n```\n                                                                  ┏━━━━━━━━━━━━━━━━━━━━━┓\n                                                                  ┃                     ┃\n                                                                  ┃      Executer       ┃\n           ┌─────────────────────────────────────────────────────▶┃     Cache, Task     ┃\n           │                                                      ┃                     ┃\n           │                                                      ┃                     ┃\n           │                                                      ┗━━━━━━━━━━━━━━━━━━━━━┛\n           │\n           │\n           │\n┏━━━━━━━━━━━━━━━━━━━━━┓          ┏━━━━━━━━━━━━━━━━━━━━━┓          ┏━━━━━━━━━━━━━━━━━━━━━┓\n┃                     ┃          ┃                     ┃          ┃                     ┃\n┃       Driver        ┃          ┃   Cluster Manager   ┃          ┃      Executer       ┃\n┃    Spark Context    ┃─────────▶┃       (Mesos)       ┃─────────▶┃     Cache, Task     ┃\n┃                     ┃          ┃                     ┃          ┃                     ┃\n┃                     ┃          ┃                     ┃          ┃                     ┃\n┗━━━━━━━━━━━━━━━━━━━━━┛          ┗━━━━━━━━━━━━━━━━━━━━━┛          ┗━━━━━━━━━━━━━━━━━━━━━┛\n           │\n           │\n           │\n           │                                                      ┏━━━━━━━━━━━━━━━━━━━━━┓\n           │                                                      ┃                     ┃\n           │                                                      ┃      Executer       ┃\n           └─────────────────────────────────────────────────────▶┃     Cache, Task     ┃\n                                                                  ┃                     ┃\n                                                                  ┃                     ┃\n                                                                  ┗━━━━━━━━━━━━━━━━━━━━━┛\n```\n\n## Resilient Distributed Dataset\nThe key concept in Spark are RDDs or Resilient Distributed Datasets.RDD is a fault-tolerant collection of elements that can be operated on in parallel.\n \n\n## Spark Application\nA typical Spark application has the following four phases:\n\n```\n┏━━━━━━━━━━━━━━━━━━━━━━━┓\n┃                       ┃\n┃      Instantiate      ┃\n┃      Input RDDs       ┃\n┃                       ┃\n┗━━━━━━━━━━━┳━━━━━━━━━━━┛\n            │\n            │\n┏━━━━━━━━━━━▼━━━━━━━━━━━┓\n┃                       ┃\n┃    Transform RDDs     ┃\n┃                       ┃\n┃                       ┃\n┗━━━━━━━━━━━┳━━━━━━━━━━━┛\n            │\n            │\n┏━━━━━━━━━━━▼━━━━━━━━━━━┓\n┃                       ┃\n┃        Persist        ┃\n┃   Intermediate RDDs   ┃\n┃                       ┃\n┗━━━━━━━━━━━┳━━━━━━━━━━━┛\n            │\n            │\n┏━━━━━━━━━━━▼━━━━━━━━━━━┓\n┃                       ┃\n┃    Action on RDDs     ┃\n┃                       ┃\n┃                       ┃\n┗━━━━━━━━━━━━━━━━━━━━━━━┛\n```\n\n## Commenting with Markdown\n\nThis block of comments and instructions is formatted as [Markdown](https://help.github.com/articles/github-flavored-markdown/). Every block of code or comments in Zeppelin is also often referred to as a paragraph. \n\nA block formatted as markdown can be specified when we start the block with `%md`. Any block is executed and rendered when we click the play button on the top-left-hand corner of a block.\n\n## Downloading the Data with Shell commands\n\nIn the next block of code we are going to download the data using shell commands. The shell command in a Zeppelin notebook can be invoked when we prepend the block of shell commands with a line containing the characters `%sh`.",
      "user":"anonymous",
      "config":{
        "tableHide":false,
        "editorSetting":{
          "language":"markdown",
          "editOnDblClick":true,
          "completionSupport":false
        },
        "colWidth":12,
        "editorMode":"ace/mode/markdown",
        "editorHide":true,
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"HTML",
            "data":"<div class=\"markdown-body\">\n<h1>Analyzing network intrusion dataset with Python and Spark</h1>\n<h2>Original work By <a href=\"http://saptak.in\">Saptak Sen</a> / Updated to Eskimo by Jerome Kehrli <a href=\"http://www.niceideas.ch\">www.niceideas.ch</a></h2>\n<hr />\n<h2>Introduction</h2>\n<p>In this tutorial we are going to analyze a network intrusion events dataset with <strong>Python</strong> in a Zeppelin Notebook. The Zeppelin Notebook provides an easy and interactive surface for data scientists to explore data through data processing engines like <strong>Hive</strong> and <strong>Spark</strong>. Hive and Spark in turn benefit from robust managability, resource allocation policies, security and scalability running on a YARN managed infrasturcture.</p>\n<pre><code>                                                                  ┏━━━━━━━━━━━━━━━━━━━━━┓\n                                                                  ┃                     ┃\n                                                                  ┃      Executer       ┃\n           ┌─────────────────────────────────────────────────────▶┃     Cache, Task     ┃\n           │                                                      ┃                     ┃\n           │                                                      ┃                     ┃\n           │                                                      ┗━━━━━━━━━━━━━━━━━━━━━┛\n           │\n           │\n           │\n┏━━━━━━━━━━━━━━━━━━━━━┓          ┏━━━━━━━━━━━━━━━━━━━━━┓          ┏━━━━━━━━━━━━━━━━━━━━━┓\n┃                     ┃          ┃                     ┃          ┃                     ┃\n┃       Driver        ┃          ┃   Cluster Manager   ┃          ┃      Executer       ┃\n┃    Spark Context    ┃─────────▶┃       (Mesos)       ┃─────────▶┃     Cache, Task     ┃\n┃                     ┃          ┃                     ┃          ┃                     ┃\n┃                     ┃          ┃                     ┃          ┃                     ┃\n┗━━━━━━━━━━━━━━━━━━━━━┛          ┗━━━━━━━━━━━━━━━━━━━━━┛          ┗━━━━━━━━━━━━━━━━━━━━━┛\n           │\n           │\n           │\n           │                                                      ┏━━━━━━━━━━━━━━━━━━━━━┓\n           │                                                      ┃                     ┃\n           │                                                      ┃      Executer       ┃\n           └─────────────────────────────────────────────────────▶┃     Cache, Task     ┃\n                                                                  ┃                     ┃\n                                                                  ┃                     ┃\n                                                                  ┗━━━━━━━━━━━━━━━━━━━━━┛\n</code></pre>\n<h2>Resilient Distributed Dataset</h2>\n<p>The key concept in Spark are RDDs or Resilient Distributed Datasets.RDD is a fault-tolerant collection of elements that can be operated on in parallel.</p>\n<h2>Spark Application</h2>\n<p>A typical Spark application has the following four phases:</p>\n<pre><code>┏━━━━━━━━━━━━━━━━━━━━━━━┓\n┃                       ┃\n┃      Instantiate      ┃\n┃      Input RDDs       ┃\n┃                       ┃\n┗━━━━━━━━━━━┳━━━━━━━━━━━┛\n            │\n            │\n┏━━━━━━━━━━━▼━━━━━━━━━━━┓\n┃                       ┃\n┃    Transform RDDs     ┃\n┃                       ┃\n┃                       ┃\n┗━━━━━━━━━━━┳━━━━━━━━━━━┛\n            │\n            │\n┏━━━━━━━━━━━▼━━━━━━━━━━━┓\n┃                       ┃\n┃        Persist        ┃\n┃   Intermediate RDDs   ┃\n┃                       ┃\n┗━━━━━━━━━━━┳━━━━━━━━━━━┛\n            │\n            │\n┏━━━━━━━━━━━▼━━━━━━━━━━━┓\n┃                       ┃\n┃    Action on RDDs     ┃\n┃                       ┃\n┃                       ┃\n┗━━━━━━━━━━━━━━━━━━━━━━━┛\n</code></pre>\n<h2>Commenting with Markdown</h2>\n<p>This block of comments and instructions is formatted as <a href=\"https://help.github.com/articles/github-flavored-markdown/\">Markdown</a>. Every block of code or comments in Zeppelin is also often referred to as a paragraph.</p>\n<p>A block formatted as markdown can be specified when we start the block with <code>%md</code>. Any block is executed and rendered when we click the play button on the top-left-hand corner of a block.</p>\n<h2>Downloading the Data with Shell commands</h2>\n<p>In the next block of code we are going to download the data using shell commands. The shell command in a Zeppelin notebook can be invoked when we prepend the block of shell commands with a line containing the characters <code>%sh</code>.</p>\n\n</div>"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151020-035411_911943644",
      "id":"20151020-035411_911943644",
      "dateCreated":"2019-11-04T12:46:06+0000",
      "status":"FINISHED",
      "focus":true,
      "$$hashKey":"object:28908",
      "runtimeInfos":{

      }
    },
    {
      "text":"%sh\n\n#remove existing copies of dataset from HDFS\nhadoop fs -rm  /tmp/kddcup.data_10_percent.gz\n\n#Download the data and place it into the /tmp folder of Hortonworks Sandbox\nwget http://kdd.ics.uci.edu/databases/kddcup99/kddcup.data_10_percent.gz -O /tmp/kddcup.data_10_percent.gz\n\n# Copying it to gluster shared /var/lib/spark/data\nmkdir /var/lib/spark/data/tmp\nmv /tmp/kddcup.data_10_percent.gz /var/lib/spark/data/tmp/\n\n\n",
      "user":"anonymous",
      "config":{
        "tableHide":false,
        "editorSetting":{
          "language":"sh",
          "editOnDblClick":false,
          "completionSupport":false
        },
        "colWidth":12,
        "editorMode":"ace/mode/sh",
        "editorHide":false,
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"TEXT",
            "data":"bash: line 1: hadoop: command not found\n--2019-11-04 12:45:59--  http://kdd.ics.uci.edu/databases/kddcup99/kddcup.data_10_percent.gz\nResolving kdd.ics.uci.edu (kdd.ics.uci.edu)... 128.195.1.86\nConnecting to kdd.ics.uci.edu (kdd.ics.uci.edu)|128.195.1.86|:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 2144903 (2.0M) [application/x-gzip]\nSaving to: '/tmp/kddcup.data_10_percent.gz'\n\n     0K .......... .......... .......... .......... ..........  2%  124K 17s\n    50K .......... .......... .......... .......... ..........  4%  176K 14s\n   100K .......... .......... .......... .......... ..........  7% 12.5M 9s\n   150K .......... .......... .......... .......... ..........  9% 24.1M 7s\n   200K .......... .......... .......... .......... .......... 11%  233K 7s\n   250K .......... .......... .......... .......... .......... 14% 22.2M 5s\n   300K .......... .......... .......... .......... .......... 16% 6.54M 5s\n   350K .......... .......... .......... .......... .......... 19%  123K 6s\n   400K .......... .......... .......... .......... .......... 21% 26.0M 5s\n   450K .......... .......... .......... .......... .......... 23% 46.4M 4s\n   500K .......... .......... .......... .......... .......... 26% 22.7M 4s\n   550K .......... .......... .......... .......... .......... 28%  254M 3s\n   600K .......... .......... .......... .......... .......... 31%  164M 3s\n   650K .......... .......... .......... .......... .......... 33%  346M 3s\n   700K .......... .......... .......... .......... .......... 35%  355M 2s\n   750K .......... .......... .......... .......... .......... 38%  242M 2s\n   800K .......... .......... .......... .......... .......... 40%  151M 2s\n   850K .......... .......... .......... .......... .......... 42%  315K 2s\n   900K .......... .......... .......... .......... .......... 45%  166M 2s\n   950K .......... .......... .......... .......... .......... 47% 22.4M 2s\n  1000K .......... .......... .......... .......... .......... 50% 22.3M 1s\n  1050K .......... .......... .......... .......... .......... 52% 13.3M 1s\n  1100K .......... .......... .......... .......... .......... 54%  343K 1s\n  1150K .......... .......... .......... .......... .......... 57% 7.71M 1s\n  1200K .......... .......... .......... .......... .......... 59% 20.9M 1s\n  1250K .......... .......... .......... .......... .......... 62% 8.19M 1s\n  1300K .......... .......... .......... .......... .......... 64% 18.8M 1s\n  1350K .......... .......... .......... .......... .......... 66%  358K 1s\n  1400K .......... .......... .......... .......... .......... 69% 7.77M 1s\n  1450K .......... .......... .......... .......... .......... 71% 4.96M 1s\n  1500K .......... .......... .......... .......... .......... 73%  104M 1s\n  1550K .......... .......... .......... .......... .......... 76% 2.15M 1s\n  1600K .......... .......... .......... .......... .......... 78%  284M 0s\n  1650K .......... .......... .......... .......... .......... 81%  246K 0s\n  1700K .......... .......... .......... .......... .......... 83% 18.9M 0s\n  1750K .......... .......... .......... .......... .......... 85% 29.7M 0s\n  1800K .......... .......... .......... .......... .......... 88%  241M 0s\n  1850K .......... .......... .......... .......... .......... 90%  317M 0s\n  1900K .......... .......... .......... .......... .......... 93%  252K 0s\n  1950K .......... .......... .......... .......... .......... 95% 11.6M 0s\n  2000K .......... .......... .......... .......... .......... 97% 29.2M 0s\n  2050K .......... .......... .......... .......... ....      100%  227M=2.3s\n\n2019-11-04 12:46:02 (929 KB/s) - '/tmp/kddcup.data_10_percent.gz' saved [2144903/2144903]\n\n"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151020-035535_1468713571",
      "id":"20151020-035535_1468713571",
      "dateCreated":"2019-11-04T12:46:02+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28909",
      "runtimeInfos":{

      }
    },
    {
      "text":"%md\n### Using Scala function calls to fetch environment variables\n\nIn the next code block we are using function calls in Scala to fetch environment information. To specify a code block as Scala it is enough to just start the code block with `%spark` \n\nWhether you are programming in Scala or Python the important thing to notice is the `sc` object better know as SparkContext.\nSparkContext is created by your driver program in this case Zeppelin and Pyspark. We will use the SparkContext to further instantiate RDDs in the next section.\n",
      "user":"anonymous",
      "config":{
        "editorSetting":{

        },
        "colWidth":12,
        "editorMode":"ace/mode/markdown",
        "editorHide":true,
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"HTML",
            "data":"<div class=\"markdown-body\">\n<p>###Using Scala function calls to fetch environment variables</p>\n<p>In the next code block we are using function calls in Scala to fetch environment information. To specify a code block as Scala it is enough to just start the code block with <code>%spark</code></p>\n<p>Whether you are programming in Scala or Python the important thing to notice is the <code>sc</code> object better know as SparkContext.<br />\nSparkContext is created by your driver program in this case Zeppelin and Pyspark. We will use the SparkContext to further instantiate RDDs in the next section.</p>\n\n</div>"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151025-002521_506859008",
      "id":"20151025-002521_506859008",
      "dateCreated":"2019-11-04T12:46:13+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28910",
      "runtimeInfos":{

      }
    },
    {
      "text":"%spark\nsc.version\nSystem.getenv().get(\"PYTHONPATH\")\nSystem.getenv().get(\"SPARK_HOME\")",
      "user":"anonymous",
      "config":{
        "editorSetting":{
          "language":"scala",
          "editOnDblClick":false,
          "completionKey":"TAB",
          "completionSupport":true
        },
        "colWidth":12,
        "editorMode":"ace/mode/scala",
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"TEXT",
            "data":"\u001b[1m\u001b[34mres4\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = /usr/local/lib/spark/\n"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151025-000911_681184475",
      "id":"20151025-000911_681184475",
      "dateCreated":"2019-11-04T12:46:16+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28911",
      "runtimeInfos":{

      }
    },
    {
      "text":"%md\n### Creating RDDs\n\nBelow we create a RDD by calling the textFile function on the SparkContext and passing the HDFS path to the raw datset. You can also create RDDs from:\n\n  * JDBC\n  * Cassandra\n  * HBase\n  * Elasticsearch\n  * JSON, CSV, sequence files, object files, ORC, Parquet, Avro\n\nThe code block below starts with `%pyspark` which indicates we are going to use the Python programming language to interact with Spark. Also for the rest of the tutorial we will continue to use PySpark.\n\nWhen we execute the next section of the code block to create the RDDs we will notice that it executes super fast. The reason it executes super fast is because it actually does not touch the data yet. You can continue to apply various transformation operations on this RDD and still it will not touch the data, but only construct a DAG or a Directed Acyclic Graph. \n",
      "user":"anonymous",
      "config":{
        "tableHide":false,
        "editorSetting":{
          "language":"markdown",
          "editOnDblClick":true,
          "completionSupport":false
        },
        "colWidth":12,
        "editorMode":"ace/mode/markdown",
        "editorHide":true,
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"HTML",
            "data":"<div class=\"markdown-body\">\n<h3>Creating RDDs</h3>\n<p>Below we create a RDD by calling the textFile function on the SparkContext and passing the HDFS path to the raw datset. You can also create RDDs from:</p>\n<ul>\n<li>JDBC</li>\n<li>Cassandra</li>\n<li>HBase</li>\n<li>Elasticsearch</li>\n<li>JSON, CSV, sequence files, object files, ORC, Parquet, Avro</li>\n</ul>\n<p>The code block below starts with <code>%pyspark</code> which indicates we are going to use the Python programming language to interact with Spark. Also for the rest of the tutorial we will continue to use PySpark.</p>\n<p>When we execute the next section of the code block to create the RDDs we will notice that it executes super fast. The reason it executes super fast is because it actually does not touch the data yet. You can continue to apply various transformation operations on this RDD and still it will not touch the data, but only construct a DAG or a Directed Acyclic Graph.</p>\n\n</div>"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151025-023520_258833607",
      "id":"20151025-023520_258833607",
      "dateCreated":"2019-11-04T12:46:25+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28912",
      "runtimeInfos":{

      }
    },
    {
      "text":"%pyspark\n\ninput_file = \"file:///var/lib/spark/data/tmp/kddcup.data_10_percent.gz\"\n\nraw_rdd = sc.textFile(input_file)",
      "user":"anonymous",
      "config":{
        "editorSetting":{
          "language":"python",
          "editOnDblClick":false,
          "completionKey":"TAB",
          "completionSupport":true
        },
        "colWidth":12,
        "editorMode":"ace/mode/python",
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[

        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[

        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151020-041058_1023360958",
      "id":"20151020-041058_1023360958",
      "dateCreated":"2019-11-04T12:46:33+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28913",
      "runtimeInfos":{

      }
    },
    {
      "text":"%md\n### RDD Actions\n\nIn the next code block we will count the number of lines in the file by calling the count function on the RDD. Count function on a RDD is a Action operation, which means Spark and YARN will be forced to allocate resource and execute the DAG it has been creating to calculate the result. We will notice that the next code block takes a little longer to run than the previous one for that reason. ",
      "user":"anonymous",
      "config":{
        "tableHide":false,
        "editorSetting":{
          "language":"markdown",
          "editOnDblClick":true,
          "completionSupport":false
        },
        "colWidth":12,
        "editorMode":"ace/mode/markdown",
        "editorHide":true,
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"HTML",
            "data":"<div class=\"markdown-body\">\n<h3>RDD Actions</h3>\n<p>In the next code block we will count the number of lines in the file by calling the count function on the RDD. Count function on a RDD is a Action operation, which means Spark and YARN will be forced to allocate resource and execute the DAG it has been creating to calculate the result. We will notice that the next code block takes a little longer to run than the previous one for that reason.</p>\n\n</div>"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151025-033801_974200319",
      "id":"20151025-033801_974200319",
      "dateCreated":"2019-11-04T12:47:02+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28914",
      "runtimeInfos":{

      }
    },
    {
      "text":"%pyspark\n\nprint raw_rdd.count()",
      "user":"anonymous",
      "config":{
        "editorSetting":{
          "language":"python",
          "editOnDblClick":false,
          "completionKey":"TAB",
          "completionSupport":true
        },
        "colWidth":12,
        "editorMode":"ace/mode/python",
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"TEXT",
            "data":"494021\n"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151020-041637_1396716094",
      "id":"20151020-041637_1396716094",
      "dateCreated":"2019-11-04T12:47:26+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28915",
      "runtimeInfos":{
        "jobUrl":{
          "propertyName":"jobUrl",
          "label":"SPARK JOB",
          "tooltip":"View in Spark web UI",
          "group":"spark",
          "values":[
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=0",
              "$$hashKey":"object:34876"
            }
          ],
          "interpreterSettingId":"spark"
        }
      }
    },
    {
      "text":"%md\n### Inspect what the data looks like",
      "user":"anonymous",
      "config":{
        "tableHide":false,
        "editorSetting":{
          "language":"markdown",
          "editOnDblClick":true,
          "completionSupport":false
        },
        "colWidth":12,
        "editorMode":"ace/mode/markdown",
        "editorHide":true,
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"HTML",
            "data":"<div class=\"markdown-body\">\n<h3>Inspect what the data looks like</h3>\n\n</div>"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151025-041754_1010831945",
      "id":"20151025-041754_1010831945",
      "dateCreated":"2019-11-04T12:47:37+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28916",
      "runtimeInfos":{

      }
    },
    {
      "text":"%pyspark\nprint raw_rdd.take(5)",
      "user":"anonymous",
      "config":{
        "editorSetting":{
          "language":"python",
          "editOnDblClick":false,
          "completionKey":"TAB",
          "completionSupport":true
        },
        "colWidth":12,
        "editorMode":"ace/mode/python",
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"TEXT",
            "data":"[u'0,tcp,http,SF,181,5450,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,8,8,0.00,0.00,0.00,0.00,1.00,0.00,0.00,9,9,1.00,0.00,0.11,0.00,0.00,0.00,0.00,0.00,normal.', u'0,tcp,http,SF,239,486,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,8,8,0.00,0.00,0.00,0.00,1.00,0.00,0.00,19,19,1.00,0.00,0.05,0.00,0.00,0.00,0.00,0.00,normal.', u'0,tcp,http,SF,235,1337,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,8,8,0.00,0.00,0.00,0.00,1.00,0.00,0.00,29,29,1.00,0.00,0.03,0.00,0.00,0.00,0.00,0.00,normal.', u'0,tcp,http,SF,219,1337,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,6,6,0.00,0.00,0.00,0.00,1.00,0.00,0.00,39,39,1.00,0.00,0.03,0.00,0.00,0.00,0.00,0.00,normal.', u'0,tcp,http,SF,217,2032,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,6,6,0.00,0.00,0.00,0.00,1.00,0.00,0.00,49,49,1.00,0.00,0.02,0.00,0.00,0.00,0.00,0.00,normal.']\n"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151020-041733_761077228",
      "id":"20151020-041733_761077228",
      "dateCreated":"2019-11-04T12:47:41+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28917",
      "runtimeInfos":{
        "jobUrl":{
          "propertyName":"jobUrl",
          "label":"SPARK JOB",
          "tooltip":"View in Spark web UI",
          "group":"spark",
          "values":[
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=1",
              "$$hashKey":"object:34951"
            }
          ],
          "interpreterSettingId":"spark"
        }
      }
    },
    {
      "text":"%md\n### Filtering lines in the data",
      "user":"anonymous",
      "config":{
        "tableHide":false,
        "editorSetting":{
          "language":"markdown",
          "editOnDblClick":true,
          "completionSupport":false
        },
        "colWidth":12,
        "editorMode":"ace/mode/markdown",
        "editorHide":true,
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"HTML",
            "data":"<div class=\"markdown-body\">\n<h3>Filtering lines in the data</h3>\n\n</div>"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151025-042742_1412779040",
      "id":"20151025-042742_1412779040",
      "dateCreated":"2019-11-04T12:47:46+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28918",
      "runtimeInfos":{

      }
    },
    {
      "text":"%pyspark\nnormal_raw_rdd = raw_rdd.filter(lambda x: 'normal.' in x)",
      "user":"anonymous",
      "config":{
        "editorSetting":{
          "language":"python",
          "editOnDblClick":false,
          "completionKey":"TAB",
          "completionSupport":true
        },
        "colWidth":12,
        "editorMode":"ace/mode/python",
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[

        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[

        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151020-153124_467610492",
      "id":"20151020-153124_467610492",
      "dateCreated":"2019-11-04T12:47:49+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28919",
      "runtimeInfos":{

      }
    },
    {
      "text":"%md\n### Count the filtered RDD",
      "user":"anonymous",
      "config":{
        "tableHide":false,
        "editorSetting":{
          "language":"markdown",
          "editOnDblClick":true,
          "completionSupport":false
        },
        "colWidth":12,
        "editorMode":"ace/mode/markdown",
        "editorHide":true,
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"HTML",
            "data":"<div class=\"markdown-body\">\n<h3>Count the filtered RDD</h3>\n\n</div>"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151025-042841_261479489",
      "id":"20151025-042841_261479489",
      "dateCreated":"2019-11-04T12:47:59+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28920",
      "runtimeInfos":{

      }
    },
    {
      "text":"%pyspark\n\nnormal_count = normal_raw_rdd.count()\n\nprint normal_count",
      "user":"anonymous",
      "config":{
        "editorSetting":{
          "language":"python",
          "editOnDblClick":false,
          "completionKey":"TAB",
          "completionSupport":true
        },
        "colWidth":12,
        "editorMode":"ace/mode/python",
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"TEXT",
            "data":"97278\n"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151020-153409_1001360617",
      "id":"20151020-153409_1001360617",
      "dateCreated":"2019-11-04T12:48:04+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28921",
      "runtimeInfos":{
        "jobUrl":{
          "propertyName":"jobUrl",
          "label":"SPARK JOB",
          "tooltip":"View in Spark web UI",
          "group":"spark",
          "values":[
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=2",
              "$$hashKey":"object:35110"
            }
          ],
          "interpreterSettingId":"spark"
        }
      }
    },
    {
      "text":"%md\n### Importing local libraries",
      "user":"anonymous",
      "config":{
        "tableHide":false,
        "editorSetting":{
          "language":"markdown",
          "editOnDblClick":true,
          "completionSupport":false
        },
        "colWidth":12,
        "editorMode":"ace/mode/markdown",
        "editorHide":true,
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"HTML",
            "data":"<div class=\"markdown-body\">\n<h3>Importing local libraries</h3>\n\n</div>"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151025-042924_1173734316",
      "id":"20151025-042924_1173734316",
      "dateCreated":"2019-11-04T12:48:07+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28922",
      "runtimeInfos":{

      }
    },
    {
      "text":"%pyspark\n\nfrom pprint import pprint\n\ncsv_rdd = raw_rdd.map(lambda x: x.split(\",\"))\n\nhead_rows = csv_rdd.take(5)\n\npprint(head_rows[0])\n",
      "user":"anonymous",
      "config":{
        "editorSetting":{
          "language":"python",
          "editOnDblClick":false,
          "completionKey":"TAB",
          "completionSupport":true
        },
        "colWidth":12,
        "editorMode":"ace/mode/python",
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"TEXT",
            "data":"[u'0',\n u'tcp',\n u'http',\n u'SF',\n u'181',\n u'5450',\n u'0',\n u'0',\n u'0',\n u'0',\n u'0',\n u'1',\n u'0',\n u'0',\n u'0',\n u'0',\n u'0',\n u'0',\n u'0',\n u'0',\n u'0',\n u'0',\n u'8',\n u'8',\n u'0.00',\n u'0.00',\n u'0.00',\n u'0.00',\n u'1.00',\n u'0.00',\n u'0.00',\n u'9',\n u'9',\n u'1.00',\n u'0.00',\n u'0.11',\n u'0.00',\n u'0.00',\n u'0.00',\n u'0.00',\n u'0.00',\n u'normal.']\n"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151020-153930_2114893315",
      "id":"20151020-153930_2114893315",
      "dateCreated":"2019-11-04T12:48:10+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28923",
      "runtimeInfos":{
        "jobUrl":{
          "propertyName":"jobUrl",
          "label":"SPARK JOB",
          "tooltip":"View in Spark web UI",
          "group":"spark",
          "values":[
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=3",
              "$$hashKey":"object:35187"
            }
          ],
          "interpreterSettingId":"spark"
        }
      }
    },
    {
      "text":"%md\n### Using map functions in transformation",
      "user":"anonymous",
      "config":{
        "tableHide":false,
        "editorSetting":{
          "language":"markdown",
          "editOnDblClick":true,
          "completionSupport":false
        },
        "colWidth":12,
        "editorMode":"ace/mode/markdown",
        "editorHide":true,
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"HTML",
            "data":"<div class=\"markdown-body\">\n<h3>Using map functions in transformation</h3>\n\n</div>"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151025-043024_234751730",
      "id":"20151025-043024_234751730",
      "dateCreated":"2019-11-04T12:48:17+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28924",
      "runtimeInfos":{

      }
    },
    {
      "text":"%pyspark\n\ndef parse_interaction(line):\n    elems = line.split(\",\")\n    tag = elems[41]\n    return (tag, elems)\n    \nkey_csv_rdd = raw_rdd.map(parse_interaction)\nhead_rows = key_csv_rdd.take(5)\npprint(head_rows[0])",
      "user":"anonymous",
      "config":{
        "editorSetting":{
          "language":"python",
          "editOnDblClick":false,
          "completionKey":"TAB",
          "completionSupport":true
        },
        "colWidth":12,
        "editorMode":"ace/mode/python",
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"TEXT",
            "data":"(u'normal.',\n [u'0',\n  u'tcp',\n  u'http',\n  u'SF',\n  u'181',\n  u'5450',\n  u'0',\n  u'0',\n  u'0',\n  u'0',\n  u'0',\n  u'1',\n  u'0',\n  u'0',\n  u'0',\n  u'0',\n  u'0',\n  u'0',\n  u'0',\n  u'0',\n  u'0',\n  u'0',\n  u'8',\n  u'8',\n  u'0.00',\n  u'0.00',\n  u'0.00',\n  u'0.00',\n  u'1.00',\n  u'0.00',\n  u'0.00',\n  u'9',\n  u'9',\n  u'1.00',\n  u'0.00',\n  u'0.11',\n  u'0.00',\n  u'0.00',\n  u'0.00',\n  u'0.00',\n  u'0.00',\n  u'normal.'])\n"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151020-154737_124701995",
      "id":"20151020-154737_124701995",
      "dateCreated":"2019-11-04T12:48:20+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28925",
      "runtimeInfos":{
        "jobUrl":{
          "propertyName":"jobUrl",
          "label":"SPARK JOB",
          "tooltip":"View in Spark web UI",
          "group":"spark",
          "values":[
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=4",
              "$$hashKey":"object:35276"
            }
          ],
          "interpreterSettingId":"spark"
        }
      }
    },
    {
      "text":"%md\n### Using collect() on the Spark driver",
      "user":"anonymous",
      "config":{
        "tableHide":false,
        "editorSetting":{
          "language":"markdown",
          "editOnDblClick":true,
          "completionSupport":false
        },
        "colWidth":12,
        "editorMode":"ace/mode/markdown",
        "editorHide":true,
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"HTML",
            "data":"<div class=\"markdown-body\">\n<h3>Using collect() on the Spark driver</h3>\n\n</div>"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151025-043052_1223908016",
      "id":"20151025-043052_1223908016",
      "dateCreated":"2019-11-04T12:48:36+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28926",
      "runtimeInfos":{

      }
    },
    {
      "text":"%pyspark\n\n#all_raw_rdd = raw_rdd.collect()\n\n",
      "user":"anonymous",
      "config":{
        "editorSetting":{
          "language":"python",
          "editOnDblClick":false,
          "completionKey":"TAB",
          "completionSupport":true
        },
        "colWidth":12,
        "editorMode":"ace/mode/python",
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[

        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[

        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151020-155215_321328122",
      "id":"20151020-155215_321328122",
      "dateCreated":"2019-11-04T12:48:38+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28927",
      "runtimeInfos":{

      }
    },
    {
      "text":"%md\n### Extracting a smaller sample of the RDD",
      "user":"anonymous",
      "config":{
        "tableHide":false,
        "editorSetting":{
          "language":"markdown",
          "editOnDblClick":true,
          "completionSupport":false
        },
        "colWidth":12,
        "editorMode":"ace/mode/markdown",
        "editorHide":true,
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"HTML",
            "data":"<div class=\"markdown-body\">\n<h3>Extracting a smaller sample of the RDD</h3>\n\n</div>"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151025-043641_741109691",
      "id":"20151025-043641_741109691",
      "dateCreated":"2019-11-04T12:48:45+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28928",
      "runtimeInfos":{

      }
    },
    {
      "text":"%pyspark\n\nraw_rdd_sample = raw_rdd.sample(False, 0.1, 1234)\nprint raw_rdd_sample.count()\nprint raw_rdd.count()",
      "user":"anonymous",
      "config":{
        "editorSetting":{
          "language":"python",
          "editOnDblClick":false,
          "completionKey":"TAB",
          "completionSupport":true
        },
        "colWidth":12,
        "editorMode":"ace/mode/python",
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"TEXT",
            "data":"49493\n494021\n"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151020-155621_1541966917",
      "id":"20151020-155621_1541966917",
      "dateCreated":"2019-11-04T12:48:52+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28929",
      "runtimeInfos":{
        "jobUrl":{
          "propertyName":"jobUrl",
          "label":"SPARK JOB",
          "tooltip":"View in Spark web UI",
          "group":"spark",
          "values":[
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=5",
              "$$hashKey":"object:35442"
            },
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=6",
              "$$hashKey":"object:35443"
            }
          ],
          "interpreterSettingId":"spark"
        }
      }
    },
    {
      "text":"%md\n### Local sample for local processing",
      "user":"anonymous",
      "config":{
        "tableHide":false,
        "editorSetting":{
          "language":"markdown",
          "editOnDblClick":true,
          "completionSupport":false
        },
        "colWidth":12,
        "editorMode":"ace/mode/markdown",
        "editorHide":true,
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"HTML",
            "data":"<div class=\"markdown-body\">\n<h3>Local sample for local processing</h3>\n\n</div>"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151025-043813_1909205882",
      "id":"20151025-043813_1909205882",
      "dateCreated":"2019-11-04T12:48:52+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28930",
      "runtimeInfos":{

      }
    },
    {
      "text":"%pyspark\n\nraw_data_local_sample = raw_rdd.takeSample(False, 1000, 1234)\n\nnormal_data_sample = [x.split(\",\") for x in raw_data_local_sample if \"normal.\" in x]\n\nnormal_data_sample_size = len(normal_data_sample)\n\nnormal_ratio = normal_data_sample_size/1000.0\n\nprint normal_ratio\n",
      "user":"anonymous",
      "config":{
        "editorSetting":{
          "language":"python",
          "editOnDblClick":false,
          "completionKey":"TAB",
          "completionSupport":true
        },
        "colWidth":12,
        "editorMode":"ace/mode/python",
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"TEXT",
            "data":"0.188\n"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151020-160650_1218451495",
      "id":"20151020-160650_1218451495",
      "dateCreated":"2019-11-04T12:49:00+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28931",
      "runtimeInfos":{
        "jobUrl":{
          "propertyName":"jobUrl",
          "label":"SPARK JOB",
          "tooltip":"View in Spark web UI",
          "group":"spark",
          "values":[
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=7",
              "$$hashKey":"object:35552"
            },
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=8",
              "$$hashKey":"object:35553"
            }
          ],
          "interpreterSettingId":"spark"
        }
      }
    },
    {
      "text":"%md\n### Subtracting on RDD from another",
      "user":"anonymous",
      "config":{
        "tableHide":false,
        "editorSetting":{
          "language":"markdown",
          "editOnDblClick":true,
          "completionSupport":false
        },
        "colWidth":12,
        "editorMode":"ace/mode/markdown",
        "editorHide":true,
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"HTML",
            "data":"<div class=\"markdown-body\">\n<h3>Subtracting on RDD from another</h3>\n\n</div>"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151025-044008_680146541",
      "id":"20151025-044008_680146541",
      "dateCreated":"2019-11-04T12:49:02+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28932",
      "runtimeInfos":{

      }
    },
    {
      "text":"%pyspark\n\nattack_raw_rdd = raw_rdd.subtract(normal_raw_rdd)\n\nprint attack_raw_rdd.count()",
      "user":"anonymous",
      "config":{
        "editorSetting":{
          "language":"python",
          "editOnDblClick":false,
          "completionKey":"TAB",
          "completionSupport":true
        },
        "colWidth":12,
        "editorMode":"ace/mode/python",
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"TEXT",
            "data":"396743\n"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151020-162431_1736006903",
      "id":"20151020-162431_1736006903",
      "dateCreated":"2019-11-04T12:49:18+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28933",
      "runtimeInfos":{
        "jobUrl":{
          "propertyName":"jobUrl",
          "label":"SPARK JOB",
          "tooltip":"View in Spark web UI",
          "group":"spark",
          "values":[
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=9",
              "$$hashKey":"object:35672"
            }
          ],
          "interpreterSettingId":"spark"
        }
      }
    },
    {
      "text":"%md\n### Listing the distinct items",
      "user":"anonymous",
      "config":{
        "tableHide":false,
        "editorSetting":{
          "language":"markdown",
          "editOnDblClick":true,
          "completionSupport":false
        },
        "colWidth":12,
        "editorMode":"ace/mode/markdown",
        "editorHide":true,
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"HTML",
            "data":"<div class=\"markdown-body\">\n<h3>Listing the distinct items</h3>\n\n</div>"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151025-044203_1596662643",
      "id":"20151025-044203_1596662643",
      "dateCreated":"2019-11-04T12:49:09+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28934",
      "runtimeInfos":{

      }
    },
    {
      "text":"%pyspark\n\nprotocols = csv_rdd.map(lambda x: x[1]).distinct()\n\nprint protocols.collect()\n",
      "user":"anonymous",
      "config":{
        "editorSetting":{
          "language":"python",
          "editOnDblClick":false,
          "completionKey":"TAB",
          "completionSupport":true
        },
        "colWidth":12,
        "editorMode":"ace/mode/python",
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"TEXT",
            "data":"[u'udp', u'icmp', u'tcp']\n"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151020-163531_966055264",
      "id":"20151020-163531_966055264",
      "dateCreated":"2019-11-04T12:49:24+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28935",
      "runtimeInfos":{
        "jobUrl":{
          "propertyName":"jobUrl",
          "label":"SPARK JOB",
          "tooltip":"View in Spark web UI",
          "group":"spark",
          "values":[
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=10",
              "$$hashKey":"object:35721"
            }
          ],
          "interpreterSettingId":"spark"
        }
      }
    },
    {
      "text":"%pyspark\n\nservices = csv_rdd.map(lambda x: x[2]).distinct()\nprint services.collect()",
      "user":"anonymous",
      "config":{
        "editorSetting":{
          "language":"python",
          "editOnDblClick":false,
          "completionKey":"TAB",
          "completionSupport":true
        },
        "colWidth":12,
        "editorMode":"ace/mode/python",
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"TEXT",
            "data":"[u'domain', u'http_443', u'Z39_50', u'smtp', u'urp_i', u'private', u'echo', u'shell', u'red_i', u'eco_i', u'sunrpc', u'ftp_data', u'urh_i', u'pm_dump', u'pop_3', u'pop_2', u'systat', u'ftp', u'uucp', u'whois', u'netbios_dgm', u'efs', u'remote_job', u'daytime', u'ntp_u', u'finger', u'ldap', u'netbios_ns', u'kshell', u'iso_tsap', u'ecr_i', u'nntp', u'printer', u'domain_u', u'uucp_path', u'courier', u'exec', u'time', u'netstat', u'telnet', u'gopher', u'rje', u'sql_net', u'link', u'auth', u'netbios_ssn', u'csnet_ns', u'X11', u'IRC', u'tftp_u', u'login', u'supdup', u'name', u'nnsp', u'mtp', u'http', u'bgp', u'ctf', u'hostnames', u'klogin', u'vmnet', u'tim_i', u'discard', u'imap4', u'other', u'ssh']\n"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151020-164018_963420148",
      "id":"20151020-164018_963420148",
      "dateCreated":"2019-11-04T12:49:31+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28936",
      "runtimeInfos":{
        "jobUrl":{
          "propertyName":"jobUrl",
          "label":"SPARK JOB",
          "tooltip":"View in Spark web UI",
          "group":"spark",
          "values":[
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=11",
              "$$hashKey":"object:35798"
            }
          ],
          "interpreterSettingId":"spark"
        }
      }
    },
    {
      "text":"%md\n### Cartesian product",
      "user":"anonymous",
      "config":{
        "tableHide":false,
        "editorSetting":{
          "language":"markdown",
          "editOnDblClick":true,
          "completionSupport":false
        },
        "colWidth":12,
        "editorMode":"ace/mode/markdown",
        "editorHide":true,
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"HTML",
            "data":"<div class=\"markdown-body\">\n<h3>Cartesian product</h3>\n\n</div>"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151025-044327_920393858",
      "id":"20151025-044327_920393858",
      "dateCreated":"2019-11-04T12:49:28+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28937",
      "runtimeInfos":{

      }
    },
    {
      "text":"%pyspark\n\nproduct = protocols.cartesian(services).collect()\n\nprint len(product)",
      "user":"anonymous",
      "config":{
        "editorSetting":{
          "language":"python",
          "editOnDblClick":false,
          "completionKey":"TAB",
          "completionSupport":true
        },
        "colWidth":12,
        "editorMode":"ace/mode/python",
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"TEXT",
            "data":"198\n"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151020-164120_1905949484",
      "id":"20151020-164120_1905949484",
      "dateCreated":"2019-11-04T12:49:33+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28938",
      "runtimeInfos":{
        "jobUrl":{
          "propertyName":"jobUrl",
          "label":"SPARK JOB",
          "tooltip":"View in Spark web UI",
          "group":"spark",
          "values":[
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=12",
              "$$hashKey":"object:35847"
            }
          ],
          "interpreterSettingId":"spark"
        }
      }
    },
    {
      "text":"%md\n### Filtering\nFiltering out the normal and attack events",
      "user":"anonymous",
      "config":{
        "tableHide":false,
        "editorSetting":{
          "language":"markdown",
          "editOnDblClick":true,
          "completionSupport":false
        },
        "colWidth":12,
        "editorMode":"ace/mode/markdown",
        "editorHide":true,
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"HTML",
            "data":"<div class=\"markdown-body\">\n<h3>Filtering</h3>\n<p>Filtering out the normal and attack events</p>\n\n</div>"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151025-044451_1279874784",
      "id":"20151025-044451_1279874784",
      "dateCreated":"2019-11-04T12:49:37+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28939",
      "runtimeInfos":{

      }
    },
    {
      "text":"%pyspark\n\nnormal_csv_data = csv_rdd.filter(lambda x: x[41]==\"normal.\")\nattack_csv_data = csv_rdd.filter(lambda x: x[41]!=\"normal.\")",
      "user":"anonymous",
      "config":{
        "editorSetting":{
          "language":"python",
          "editOnDblClick":false,
          "completionKey":"TAB",
          "completionSupport":true
        },
        "colWidth":12,
        "editorMode":"ace/mode/python",
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[

        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[

        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151020-164638_2050317014",
      "id":"20151020-164638_2050317014",
      "dateCreated":"2019-11-04T12:49:42+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28940",
      "runtimeInfos":{

      }
    },
    {
      "text":"%md\n### Reduce",
      "user":"anonymous",
      "config":{
        "tableHide":false,
        "editorSetting":{
          "language":"markdown",
          "editOnDblClick":true,
          "completionSupport":false
        },
        "colWidth":12,
        "editorMode":"ace/mode/markdown",
        "editorHide":true,
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"HTML",
            "data":"<div class=\"markdown-body\">\n<h3>Reduce</h3>\n\n</div>"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151025-044553_1060339044",
      "id":"20151025-044553_1060339044",
      "dateCreated":"2019-11-04T14:02:22+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28941",
      "runtimeInfos":{

      }
    },
    {
      "text":"%pyspark\n\nnormal_duration_data = normal_csv_data.map(lambda x: int(x[0]))\ntotal_normal_duration = normal_duration_data.reduce(lambda x, y: x + y)\nprint total_normal_duration\n\nattack_duration_data = attack_csv_data.map(lambda x: int(x[0]))\ntotal_attack_duration = attack_duration_data.reduce(lambda x, y: x + y)\nprint total_attack_duration",
      "user":"anonymous",
      "config":{
        "editorSetting":{
          "language":"python",
          "editOnDblClick":false,
          "completionKey":"TAB",
          "completionSupport":true
        },
        "colWidth":12,
        "editorMode":"ace/mode/python",
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"TEXT",
            "data":"21075991\n2626792\n"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151020-164253_1147743871",
      "id":"20151020-164253_1147743871",
      "dateCreated":"2019-11-04T14:02:47+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28942",
      "runtimeInfos":{
        "jobUrl":{
          "propertyName":"jobUrl",
          "label":"SPARK JOB",
          "tooltip":"View in Spark web UI",
          "group":"spark",
          "values":[
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=13",
              "$$hashKey":"object:36007"
            },
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=14",
              "$$hashKey":"object:36008"
            }
          ],
          "interpreterSettingId":"spark"
        }
      }
    },
    {
      "text":"%md\n\n### Deriving Mean",
      "user":"anonymous",
      "config":{
        "tableHide":false,
        "editorSetting":{
          "language":"markdown",
          "editOnDblClick":true,
          "completionSupport":false
        },
        "colWidth":12,
        "editorMode":"ace/mode/markdown",
        "editorHide":true,
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"HTML",
            "data":"<div class=\"markdown-body\">\n<h3>Deriving Mean</h3>\n\n</div>"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151025-161102_1843984349",
      "id":"20151025-161102_1843984349",
      "dateCreated":"2019-11-04T14:02:50+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28943",
      "runtimeInfos":{

      }
    },
    {
      "text":"%pyspark\n\nnormal_count = normal_duration_data.count()\nattack_count = attack_duration_data.count()\n\nprint round(total_normal_duration/float(normal_count),3)\nprint round(total_attack_duration/float(attack_count),3)",
      "user":"anonymous",
      "config":{
        "editorSetting":{
          "language":"python",
          "editOnDblClick":false,
          "completionKey":"TAB",
          "completionSupport":true
        },
        "colWidth":12,
        "editorMode":"ace/mode/python",
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"TEXT",
            "data":"216.657\n6.621\n"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151020-165248_1533675296",
      "id":"20151020-165248_1533675296",
      "dateCreated":"2019-11-04T14:03:02+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28944",
      "runtimeInfos":{
        "jobUrl":{
          "propertyName":"jobUrl",
          "label":"SPARK JOB",
          "tooltip":"View in Spark web UI",
          "group":"spark",
          "values":[
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=15",
              "$$hashKey":"object:36136"
            },
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=16",
              "$$hashKey":"object:36137"
            }
          ],
          "interpreterSettingId":"spark"
        }
      }
    },
    {
      "text":"%md\n\n### Using Aggregate functions to calulate mean in one pass",
      "user":"anonymous",
      "config":{
        "tableHide":false,
        "editorSetting":{
          "language":"markdown",
          "editOnDblClick":true,
          "completionSupport":false
        },
        "colWidth":12,
        "editorMode":"ace/mode/markdown",
        "editorHide":true,
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"HTML",
            "data":"<div class=\"markdown-body\">\n<h3>Using Aggregate functions to calulate mean in one pass</h3>\n\n</div>"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151025-161243_1508443786",
      "id":"20151025-161243_1508443786",
      "dateCreated":"2019-11-04T14:02:58+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28945",
      "runtimeInfos":{

      }
    },
    {
      "text":"%pyspark\n\nnormal_sum_count = normal_duration_data.aggregate(\n    (0,0), # the initial value\n    (lambda acc, value: (acc[0] + value, acc[1] + 1)), # combine val/acc\n    (lambda acc1, acc2: (acc1[0] + acc2[0], acc1[1] + acc2[1]))\n)\n\nprint round(normal_sum_count[0]/float(normal_sum_count[1]),3)\n\nattack_sum_count = attack_duration_data.aggregate(\n    (0,0), # the initial value\n    (lambda acc, value: (acc[0] + value, acc[1] + 1)), # combine value with acc\n    (lambda acc1, acc2: (acc1[0] + acc2[0], acc1[1] + acc2[1])) # combine accumulators\n)\n\nprint round(attack_sum_count[0]/float(attack_sum_count[1]),3)",
      "user":"anonymous",
      "config":{
        "editorSetting":{
          "language":"python",
          "editOnDblClick":false,
          "completionKey":"TAB",
          "completionSupport":true
        },
        "colWidth":12,
        "editorMode":"ace/mode/python",
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"TEXT",
            "data":"216.657\n6.621\n"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151020-165707_2016593579",
      "id":"20151020-165707_2016593579",
      "dateCreated":"2019-11-04T14:03:12+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28946",
      "runtimeInfos":{
        "jobUrl":{
          "propertyName":"jobUrl",
          "label":"SPARK JOB",
          "tooltip":"View in Spark web UI",
          "group":"spark",
          "values":[
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=17",
              "$$hashKey":"object:36231"
            },
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=18",
              "$$hashKey":"object:36232"
            }
          ],
          "interpreterSettingId":"spark"
        }
      }
    },
    {
      "text":"%md\n\n### Constructing a Key-Value RDD",
      "user":"anonymous",
      "config":{
        "tableHide":false,
        "editorSetting":{
          "language":"markdown",
          "editOnDblClick":true,
          "completionSupport":false
        },
        "colWidth":12,
        "editorMode":"ace/mode/markdown",
        "editorHide":true,
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"HTML",
            "data":"<div class=\"markdown-body\">\n<h3>Constructing a Key-Value RDD</h3>\n\n</div>"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151025-161349_962088361",
      "id":"20151025-161349_962088361",
      "dateCreated":"2019-11-04T14:03:08+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28947",
      "runtimeInfos":{

      }
    },
    {
      "text":"%pyspark\n\nkey_value_rdd = csv_rdd.map(lambda x: (x[41], x))\n\nprint key_value_rdd.take(1)",
      "user":"anonymous",
      "config":{
        "editorSetting":{
          "language":"python",
          "editOnDblClick":false,
          "completionKey":"TAB",
          "completionSupport":true
        },
        "colWidth":12,
        "editorMode":"ace/mode/python",
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"TEXT",
            "data":"[(u'normal.', [u'0', u'tcp', u'http', u'SF', u'181', u'5450', u'0', u'0', u'0', u'0', u'0', u'1', u'0', u'0', u'0', u'0', u'0', u'0', u'0', u'0', u'0', u'0', u'8', u'8', u'0.00', u'0.00', u'0.00', u'0.00', u'1.00', u'0.00', u'0.00', u'9', u'9', u'1.00', u'0.00', u'0.11', u'0.00', u'0.00', u'0.00', u'0.00', u'0.00', u'normal.'])]\n"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151020-170153_1603800777",
      "id":"20151020-170153_1603800777",
      "dateCreated":"2019-11-04T14:03:14+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28948",
      "runtimeInfos":{
        "jobUrl":{
          "propertyName":"jobUrl",
          "label":"SPARK JOB",
          "tooltip":"View in Spark web UI",
          "group":"spark",
          "values":[
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=19",
              "$$hashKey":"object:36285"
            }
          ],
          "interpreterSettingId":"spark"
        }
      }
    },
    {
      "text":"%md\n### Using reduceByKey to group and aggregate",
      "user":"anonymous",
      "config":{
        "tableHide":false,
        "editorSetting":{
          "language":"markdown",
          "editOnDblClick":true,
          "completionSupport":false
        },
        "colWidth":12,
        "editorMode":"ace/mode/markdown",
        "editorHide":true,
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"HTML",
            "data":"<div class=\"markdown-body\">\n<h3>Using reduceByKey to group and aggregate</h3>\n\n</div>"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151025-161435_1491781947",
      "id":"20151025-161435_1491781947",
      "dateCreated":"2019-11-04T14:03:26+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28949",
      "runtimeInfos":{

      }
    },
    {
      "text":"%pyspark\n\nkey_value_duration = csv_rdd.map(lambda x: (x[41], float(x[0]))) \ndurations_by_key = key_value_duration.reduceByKey(lambda x, y: x + y)\n\nprint durations_by_key.collect()",
      "user":"anonymous",
      "config":{
        "editorSetting":{
          "language":"python",
          "editOnDblClick":false,
          "completionKey":"TAB",
          "completionSupport":true
        },
        "colWidth":12,
        "editorMode":"ace/mode/python",
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"TEXT",
            "data":"[(u'guess_passwd.', 144.0), (u'nmap.', 0.0), (u'warezmaster.', 301.0), (u'rootkit.', 1008.0), (u'warezclient.', 627563.0), (u'smurf.', 0.0), (u'pod.', 0.0), (u'neptune.', 0.0), (u'normal.', 21075991.0), (u'spy.', 636.0), (u'ftp_write.', 259.0), (u'phf.', 18.0), (u'portsweep.', 1991911.0), (u'teardrop.', 0.0), (u'buffer_overflow.', 2751.0), (u'land.', 0.0), (u'imap.', 72.0), (u'loadmodule.', 326.0), (u'perl.', 124.0), (u'multihop.', 1288.0), (u'back.', 284.0), (u'ipsweep.', 43.0), (u'satan.', 64.0)]\n"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151020-170625_2051205977",
      "id":"20151020-170625_2051205977",
      "dateCreated":"2019-11-04T14:03:34+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28950",
      "runtimeInfos":{
        "jobUrl":{
          "propertyName":"jobUrl",
          "label":"SPARK JOB",
          "tooltip":"View in Spark web UI",
          "group":"spark",
          "values":[
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=20",
              "$$hashKey":"object:36378"
            }
          ],
          "interpreterSettingId":"spark"
        }
      }
    },
    {
      "text":"%md\n### Using countByKey on a key-value RDD",
      "user":"anonymous",
      "config":{
        "tableHide":false,
        "editorSetting":{
          "language":"markdown",
          "editOnDblClick":true,
          "completionSupport":false
        },
        "colWidth":12,
        "editorMode":"ace/mode/markdown",
        "editorHide":true,
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"HTML",
            "data":"<div class=\"markdown-body\">\n<h3>Using countByKey on a key-value RDD</h3>\n\n</div>"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151025-161633_1074893320",
      "id":"20151025-161633_1074893320",
      "dateCreated":"2019-11-04T14:03:36+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28951",
      "runtimeInfos":{

      }
    },
    {
      "text":"%pyspark\n\ncounts_by_key = key_value_rdd.countByKey()\nprint counts_by_key",
      "user":"anonymous",
      "config":{
        "editorSetting":{
          "language":"python",
          "editOnDblClick":false,
          "completionKey":"TAB",
          "completionSupport":true
        },
        "colWidth":12,
        "editorMode":"ace/mode/python",
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"TEXT",
            "data":"defaultdict(<type 'int'>, {u'guess_passwd.': 53, u'nmap.': 231, u'warezmaster.': 20, u'rootkit.': 10, u'warezclient.': 1020, u'smurf.': 280790, u'pod.': 264, u'neptune.': 107201, u'normal.': 97278, u'spy.': 2, u'ftp_write.': 8, u'phf.': 4, u'portsweep.': 1040, u'teardrop.': 979, u'buffer_overflow.': 30, u'land.': 21, u'imap.': 12, u'loadmodule.': 9, u'perl.': 3, u'multihop.': 7, u'back.': 2203, u'ipsweep.': 1247, u'satan.': 1589})\n"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151020-170817_439456736",
      "id":"20151020-170817_439456736",
      "dateCreated":"2019-11-04T14:03:45+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28952",
      "runtimeInfos":{
        "jobUrl":{
          "propertyName":"jobUrl",
          "label":"SPARK JOB",
          "tooltip":"View in Spark web UI",
          "group":"spark",
          "values":[
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=21",
              "$$hashKey":"object:36462"
            }
          ],
          "interpreterSettingId":"spark"
        }
      }
    },
    {
      "text":"%md\n\n### Using combineByKey to get duration and attempts by type in a single pass from a key-value RDD",
      "user":"anonymous",
      "config":{
        "tableHide":false,
        "editorSetting":{
          "language":"markdown",
          "editOnDblClick":true,
          "completionSupport":false
        },
        "colWidth":12,
        "editorMode":"ace/mode/markdown",
        "editorHide":true,
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"HTML",
            "data":"<div class=\"markdown-body\">\n<h3>Using combineByKey to get duration and attempts by type in a single pass from a key-value RDD</h3>\n\n</div>"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151025-161924_2005284664",
      "id":"20151025-161924_2005284664",
      "dateCreated":"2019-11-04T14:03:46+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28953",
      "runtimeInfos":{

      }
    },
    {
      "text":"%pyspark\n\nsum_counts = key_value_duration.combineByKey(\n    (lambda x: (x, 1)), # the initial value, with value x and count 1\n    (lambda acc, value: (acc[0]+value, acc[1]+1)), # how to combine a pair value with the accumulator: sum value, and increment count\n    (lambda acc1, acc2: (acc1[0]+acc2[0], acc1[1]+acc2[1])) # combine accumulators\n)\n\nprint sum_counts.collectAsMap()",
      "user":"anonymous",
      "config":{
        "editorSetting":{
          "language":"python",
          "editOnDblClick":false,
          "completionKey":"TAB",
          "completionSupport":true
        },
        "colWidth":12,
        "editorMode":"ace/mode/python",
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"TEXT",
            "data":"{u'guess_passwd.': (144.0, 53), u'nmap.': (0.0, 231), u'loadmodule.': (326.0, 9), u'rootkit.': (1008.0, 10), u'warezclient.': (627563.0, 1020), u'smurf.': (0.0, 280790), u'pod.': (0.0, 264), u'neptune.': (0.0, 107201), u'normal.': (21075991.0, 97278), u'spy.': (636.0, 2), u'ftp_write.': (259.0, 8), u'phf.': (18.0, 4), u'portsweep.': (1991911.0, 1040), u'teardrop.': (0.0, 979), u'buffer_overflow.': (2751.0, 30), u'land.': (0.0, 21), u'imap.': (72.0, 12), u'warezmaster.': (301.0, 20), u'perl.': (124.0, 3), u'multihop.': (1288.0, 7), u'back.': (284.0, 2203), u'ipsweep.': (43.0, 1247), u'satan.': (64.0, 1589)}\n"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151020-170956_1204906051",
      "id":"20151020-170956_1204906051",
      "dateCreated":"2019-11-04T14:03:54+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28954",
      "runtimeInfos":{
        "jobUrl":{
          "propertyName":"jobUrl",
          "label":"SPARK JOB",
          "tooltip":"View in Spark web UI",
          "group":"spark",
          "values":[
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=22",
              "$$hashKey":"object:36554"
            }
          ],
          "interpreterSettingId":"spark"
        }
      }
    },
    {
      "text":"%md\n### Sorting a key-value RDD",
      "user":"anonymous",
      "config":{
        "tableHide":false,
        "editorSetting":{
          "language":"markdown",
          "editOnDblClick":true,
          "completionSupport":false
        },
        "colWidth":12,
        "editorMode":"ace/mode/markdown",
        "editorHide":true,
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"HTML",
            "data":"<div class=\"markdown-body\">\n<h3>Sorting a key-value RDD</h3>\n\n</div>"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151025-162043_805316413",
      "id":"20151025-162043_805316413",
      "dateCreated":"2019-11-04T14:03:57+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28955",
      "runtimeInfos":{

      }
    },
    {
      "text":"%pyspark\n\nduration_means_by_type = sum_counts.map(lambda (key,value): (key, round(value[0]/value[1],3))).collectAsMap()\n\n# Print them sorted\nfor tag in sorted(duration_means_by_type, key=duration_means_by_type.get, reverse=True):\n    print tag, duration_means_by_type[tag]",
      "user":"anonymous",
      "config":{
        "editorSetting":{
          "language":"python",
          "editOnDblClick":false,
          "completionKey":"TAB",
          "completionSupport":true
        },
        "colWidth":12,
        "editorMode":"ace/mode/python",
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"TEXT",
            "data":"portsweep. 1915.299\nwarezclient. 615.258\nspy. 318.0\nnormal. 216.657\nmultihop. 184.0\nrootkit. 100.8\nbuffer_overflow. 91.7\nperl. 41.333\nloadmodule. 36.222\nftp_write. 32.375\nwarezmaster. 15.05\nimap. 6.0\nphf. 4.5\nguess_passwd. 2.717\nback. 0.129\nsatan. 0.04\nipsweep. 0.034\nnmap. 0.0\nsmurf. 0.0\npod. 0.0\nneptune. 0.0\nteardrop. 0.0\nland. 0.0\n"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151020-171127_166126716",
      "id":"20151020-171127_166126716",
      "dateCreated":"2019-11-04T14:04:01+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28956",
      "runtimeInfos":{
        "jobUrl":{
          "propertyName":"jobUrl",
          "label":"SPARK JOB",
          "tooltip":"View in Spark web UI",
          "group":"spark",
          "values":[
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=23",
              "$$hashKey":"object:36637"
            }
          ],
          "interpreterSettingId":"spark"
        }
      }
    },
    {
      "text":"%md\n\n### Creating a DataFrame",
      "user":"anonymous",
      "config":{
        "tableHide":false,
        "editorSetting":{
          "language":"markdown",
          "editOnDblClick":true,
          "completionSupport":false
        },
        "colWidth":12,
        "editorMode":"ace/mode/markdown",
        "editorHide":true,
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"HTML",
            "data":"<div class=\"markdown-body\">\n<h3>Creating a DataFrame</h3>\n\n</div>"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151025-162202_1511009897",
      "id":"20151025-162202_1511009897",
      "dateCreated":"2019-11-04T14:04:08+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28957",
      "runtimeInfos":{

      }
    },
    {
      "text":"%pyspark\n\nfrom pyspark.sql import Row\n\nrow_data = csv_rdd.map(lambda p: Row(\n    duration=int(p[0]), \n    protocol_type=p[1],\n    service=p[2],\n    flag=p[3],\n    src_bytes=int(p[4]),\n    dst_bytes=int(p[5])\n    )\n)\n\ninteractions_df = sqlContext.createDataFrame(row_data)\ninteractions_df.registerTempTable(\"interactions\")",
      "user":"anonymous",
      "config":{
        "editorSetting":{
          "language":"python",
          "editOnDblClick":false,
          "completionKey":"TAB",
          "completionSupport":true
        },
        "colWidth":12,
        "editorMode":"ace/mode/python",
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[

        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[

        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151020-171250_677927139",
      "id":"20151020-171250_677927139",
      "dateCreated":"2019-11-04T14:04:12+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28958",
      "runtimeInfos":{
        "jobUrl":{
          "propertyName":"jobUrl",
          "label":"SPARK JOB",
          "tooltip":"View in Spark web UI",
          "group":"spark",
          "values":[
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=24",
              "$$hashKey":"object:36711"
            }
          ],
          "interpreterSettingId":"spark"
        }
      }
    },
    {
      "text":"%md\n### Querying with SQL statments over a DataFrame",
      "user":"anonymous",
      "config":{
        "tableHide":false,
        "editorSetting":{
          "language":"markdown",
          "editOnDblClick":true,
          "completionSupport":false
        },
        "colWidth":12,
        "editorMode":"ace/mode/markdown",
        "editorHide":true,
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"HTML",
            "data":"<div class=\"markdown-body\">\n<h3>Querying with SQL statments over a DataFrame</h3>\n\n</div>"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151025-162240_154982058",
      "id":"20151025-162240_154982058",
      "dateCreated":"2019-11-04T14:04:18+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28959",
      "runtimeInfos":{

      }
    },
    {
      "text":"%sql\n\nSELECT duration, dst_bytes FROM interactions WHERE protocol_type = 'tcp' AND duration > 1000 AND dst_bytes = 0",
      "user":"anonymous",
      "config":{
        "editorSetting":{
          "language":"sql",
          "editOnDblClick":false,
          "completionKey":"TAB",
          "completionSupport":true
        },
        "colWidth":12,
        "editorMode":"ace/mode/sql",
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              },
              "setting":{
                "table":{
                  "tableGridState":{

                  },
                  "tableColumnTypeState":{
                    "names":{
                      "duration":"string",
                      "dst_bytes":"string"
                    },
                    "updated":false
                  },
                  "tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue":{
                    "useFilter":false,
                    "showPagination":false,
                    "showAggregationFooter":false
                  },
                  "updated":false,
                  "initialized":false
                }
              },
              "commonSetting":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"TABLE",
            "data":"duration\tdst_bytes\n5057\t0\n5059\t0\n5051\t0\n5056\t0\n5051\t0\n5039\t0\n5062\t0\n5041\t0\n5056\t0\n5064\t0\n5043\t0\n5061\t0\n5049\t0\n5061\t0\n5048\t0\n5047\t0\n5044\t0\n5063\t0\n5068\t0\n5062\t0\n5046\t0\n5052\t0\n5044\t0\n5054\t0\n5039\t0\n5058\t0\n5051\t0\n5032\t0\n5063\t0\n5040\t0\n5051\t0\n5066\t0\n5044\t0\n5051\t0\n5036\t0\n5055\t0\n2426\t0\n5047\t0\n5057\t0\n5037\t0\n5057\t0\n5062\t0\n5051\t0\n5051\t0\n5053\t0\n5064\t0\n5044\t0\n5051\t0\n5033\t0\n5066\t0\n5063\t0\n5056\t0\n5042\t0\n5063\t0\n5060\t0\n5056\t0\n5049\t0\n5043\t0\n5039\t0\n5041\t0\n42448\t0\n42088\t0\n41065\t0\n40929\t0\n40806\t0\n40682\t0\n40571\t0\n40448\t0\n40339\t0\n40232\t0\n40121\t0\n36783\t0\n36674\t0\n36570\t0\n36467\t0\n36323\t0\n36204\t0\n32038\t0\n31925\t0\n31809\t0\n31709\t0\n31601\t0\n31501\t0\n31401\t0\n31301\t0\n31194\t0\n31061\t0\n30935\t0\n30835\t0\n30735\t0\n30619\t0\n30518\t0\n30418\t0\n30317\t0\n30217\t0\n30077\t0\n25420\t0\n22921\t0\n22821\t0\n22721\t0\n22616\t0\n22516\t0\n22416\t0\n22316\t0\n22216\t0\n21987\t0\n21887\t0\n21767\t0\n21661\t0\n21561\t0\n21455\t0\n21334\t0\n21223\t0\n21123\t0\n20983\t0\n14682\t0\n14420\t0\n14319\t0\n14198\t0\n14098\t0\n13998\t0\n13898\t0\n13796\t0\n13678\t0\n13578\t0\n13448\t0\n13348\t0\n13241\t0\n13141\t0\n13033\t0\n12933\t0\n12833\t0\n12733\t0\n12001\t0\n5678\t0\n5010\t0\n1298\t0\n1031\t0\n36438\t0\n"
          },
          {
            "type":"TEXT",
            "data":""
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151020-194340_1845988549",
      "id":"20151020-194340_1845988549",
      "dateCreated":"2019-11-04T14:19:11+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28960",
      "runtimeInfos":{
        "jobUrl":{
          "propertyName":"jobUrl",
          "label":"SPARK JOB",
          "tooltip":"View in Spark web UI",
          "group":"spark",
          "values":[
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=25",
              "$$hashKey":"object:36878"
            }
          ],
          "interpreterSettingId":"spark"
        }
      }
    },
    {
      "text":"%md\n### Printing the schema of the DataFrame",
      "user":"anonymous",
      "config":{
        "tableHide":false,
        "editorSetting":{
          "language":"markdown",
          "editOnDblClick":true,
          "completionSupport":false
        },
        "colWidth":12,
        "editorMode":"ace/mode/markdown",
        "editorHide":true,
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"HTML",
            "data":"<div class=\"markdown-body\">\n<h3>Printing the schema of the DataFrame</h3>\n\n</div>"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151025-162341_1003254343",
      "id":"20151025-162341_1003254343",
      "dateCreated":"2019-11-04T14:18:54+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28961",
      "runtimeInfos":{

      }
    },
    {
      "text":"%pyspark\n\ninteractions_df.printSchema()",
      "user":"anonymous",
      "config":{
        "editorSetting":{
          "language":"python",
          "editOnDblClick":false,
          "completionKey":"TAB",
          "completionSupport":true
        },
        "colWidth":12,
        "editorMode":"ace/mode/python",
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"TEXT",
            "data":"root\n |-- dst_bytes: long (nullable = true)\n |-- duration: long (nullable = true)\n |-- flag: string (nullable = true)\n |-- protocol_type: string (nullable = true)\n |-- service: string (nullable = true)\n |-- src_bytes: long (nullable = true)\n\n"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151020-194417_1802294435",
      "id":"20151020-194417_1802294435",
      "dateCreated":"2019-11-04T14:18:56+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28962",
      "runtimeInfos":{

      }
    },
    {
      "text":"%md \n### Querying a DataFrame",
      "user":"anonymous",
      "config":{
        "tableHide":false,
        "editorSetting":{
          "language":"markdown",
          "editOnDblClick":true,
          "completionSupport":false
        },
        "colWidth":12,
        "editorMode":"ace/mode/markdown",
        "editorHide":true,
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"HTML",
            "data":"<div class=\"markdown-body\">\n<h3>Querying a DataFrame</h3>\n\n</div>"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151025-162335_648508524",
      "id":"20151025-162335_648508524",
      "dateCreated":"2019-11-04T14:19:05+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28963",
      "runtimeInfos":{

      }
    },
    {
      "text":"%pyspark\n\ninteractions_df.select(\"protocol_type\", \"duration\", \"dst_bytes\").groupBy(\"protocol_type\").count().show()",
      "user":"anonymous",
      "config":{
        "editorSetting":{
          "language":"python",
          "editOnDblClick":false,
          "completionKey":"TAB",
          "completionSupport":true
        },
        "colWidth":12,
        "editorMode":"ace/mode/python",
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"TEXT",
            "data":"+-------------+------+\n|protocol_type| count|\n+-------------+------+\n|          tcp|190065|\n|          udp| 20354|\n|         icmp|283602|\n+-------------+------+\n\n"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151020-194709_695055854",
      "id":"20151020-194709_695055854",
      "dateCreated":"2019-11-04T14:19:52+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28964",
      "runtimeInfos":{
        "jobUrl":{
          "propertyName":"jobUrl",
          "label":"SPARK JOB",
          "tooltip":"View in Spark web UI",
          "group":"spark",
          "values":[
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=26",
              "$$hashKey":"object:37621"
            },
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=27",
              "$$hashKey":"object:37622"
            },
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=28",
              "$$hashKey":"object:37623"
            },
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=29",
              "$$hashKey":"object:37624"
            },
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=30",
              "$$hashKey":"object:37625"
            }
          ],
          "interpreterSettingId":"spark"
        }
      }
    },
    {
      "text":"%pyspark\n\ninteractions_df.select(\"protocol_type\", \"duration\", \"dst_bytes\").filter(interactions_df.duration>1000).filter(interactions_df.dst_bytes==0).groupBy(\"protocol_type\").count().show()",
      "user":"anonymous",
      "config":{
        "editorSetting":{
          "language":"python",
          "editOnDblClick":false,
          "completionKey":"TAB",
          "completionSupport":true
        },
        "colWidth":12,
        "editorMode":"ace/mode/python",
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"TEXT",
            "data":"+-------------+-----+\n|protocol_type|count|\n+-------------+-----+\n|          tcp|  139|\n+-------------+-----+\n\n"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151020-195405_164097486",
      "id":"20151020-195405_164097486",
      "dateCreated":"2019-11-04T14:20:18+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28965",
      "runtimeInfos":{
        "jobUrl":{
          "propertyName":"jobUrl",
          "label":"SPARK JOB",
          "tooltip":"View in Spark web UI",
          "group":"spark",
          "values":[
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=31",
              "$$hashKey":"object:37723"
            },
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=32",
              "$$hashKey":"object:37724"
            },
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=33",
              "$$hashKey":"object:37725"
            },
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=34",
              "$$hashKey":"object:37726"
            },
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=35",
              "$$hashKey":"object:37727"
            }
          ],
          "interpreterSettingId":"spark"
        }
      }
    },
    {
      "text":"%md\n\n### Calculating a derived column on a DataFrame",
      "user":"anonymous",
      "config":{
        "tableHide":false,
        "editorSetting":{
          "language":"markdown",
          "editOnDblClick":true,
          "completionSupport":false
        },
        "colWidth":12,
        "editorMode":"ace/mode/markdown",
        "editorHide":true,
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"HTML",
            "data":"<div class=\"markdown-body\">\n<h3>Calculating a derived column on a DataFrame</h3>\n\n</div>"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151025-162508_1142356987",
      "id":"20151025-162508_1142356987",
      "dateCreated":"2019-11-04T14:20:43+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28966",
      "runtimeInfos":{

      }
    },
    {
      "text":"%pyspark\n\ndef get_label_type(label):\n    if label!=\"normal.\":\n        return \"attack\"\n    else:\n        return \"normal\"\n    \nrow_labeled_data = csv_rdd.map(lambda p: Row(\n    duration=int(p[0]), \n    protocol_type=p[1],\n    service=p[2],\n    flag=p[3],\n    src_bytes=int(p[4]),\n    dst_bytes=int(p[5]),\n    label=get_label_type(p[41])\n    )\n)\ninteractions_labeled_df = sqlContext.createDataFrame(row_labeled_data)",
      "user":"anonymous",
      "config":{
        "editorSetting":{
          "language":"python",
          "editOnDblClick":false,
          "completionKey":"TAB",
          "completionSupport":true
        },
        "colWidth":12,
        "editorMode":"ace/mode/python",
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[

        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[

        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151020-195641_1610602237",
      "id":"20151020-195641_1610602237",
      "dateCreated":"2019-11-04T14:20:46+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28967",
      "runtimeInfos":{
        "jobUrl":{
          "propertyName":"jobUrl",
          "label":"SPARK JOB",
          "tooltip":"View in Spark web UI",
          "group":"spark",
          "values":[
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=36",
              "$$hashKey":"object:37792"
            }
          ],
          "interpreterSettingId":"spark"
        }
      }
    },
    {
      "text":"%pyspark\n\ninteractions_labeled_df.select(\"label\").groupBy(\"label\").count().show()",
      "user":"anonymous",
      "config":{
        "editorSetting":{
          "language":"python",
          "editOnDblClick":false,
          "completionKey":"TAB",
          "completionSupport":true
        },
        "colWidth":12,
        "editorMode":"ace/mode/python",
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"TEXT",
            "data":"+------+------+\n| label| count|\n+------+------+\n|normal| 97278|\n|attack|396743|\n+------+------+\n\n"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151020-195909_100412061",
      "id":"20151020-195909_100412061",
      "dateCreated":"2019-11-04T14:21:05+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28968",
      "runtimeInfos":{
        "jobUrl":{
          "propertyName":"jobUrl",
          "label":"SPARK JOB",
          "tooltip":"View in Spark web UI",
          "group":"spark",
          "values":[
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=37",
              "$$hashKey":"object:37943"
            },
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=38",
              "$$hashKey":"object:37944"
            },
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=39",
              "$$hashKey":"object:37945"
            },
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=40",
              "$$hashKey":"object:37946"
            },
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=41",
              "$$hashKey":"object:37947"
            }
          ],
          "interpreterSettingId":"spark"
        }
      }
    },
    {
      "text":"%md\n\n### groupBY on a DataFrame ",
      "user":"anonymous",
      "config":{
        "tableHide":false,
        "editorSetting":{
          "language":"markdown",
          "editOnDblClick":true,
          "completionSupport":false
        },
        "colWidth":12,
        "editorMode":"ace/mode/markdown",
        "editorHide":true,
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"HTML",
            "data":"<div class=\"markdown-body\">\n<h3>groupBY on a DataFrame</h3>\n\n</div>"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151025-162617_120349085",
      "id":"20151025-162617_120349085",
      "dateCreated":"2019-11-04T14:20:55+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28969",
      "runtimeInfos":{

      }
    },
    {
      "text":"%pyspark\n\ninteractions_labeled_df.select(\"label\", \"protocol_type\").groupBy(\"label\", \"protocol_type\").count().show()",
      "user":"anonymous",
      "config":{
        "editorSetting":{
          "language":"python",
          "editOnDblClick":false,
          "completionKey":"TAB",
          "completionSupport":true
        },
        "colWidth":12,
        "editorMode":"ace/mode/python",
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"TEXT",
            "data":"+------+-------------+------+\n| label|protocol_type| count|\n+------+-------------+------+\n|normal|          udp| 19177|\n|normal|         icmp|  1288|\n|normal|          tcp| 76813|\n|attack|         icmp|282314|\n|attack|          tcp|113252|\n|attack|          udp|  1177|\n+------+-------------+------+\n\n"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151020-195957_179265569",
      "id":"20151020-195957_179265569",
      "dateCreated":"2019-11-04T14:21:24+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28970",
      "runtimeInfos":{
        "jobUrl":{
          "propertyName":"jobUrl",
          "label":"SPARK JOB",
          "tooltip":"View in Spark web UI",
          "group":"spark",
          "values":[
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=42",
              "$$hashKey":"object:38100"
            },
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=43",
              "$$hashKey":"object:38101"
            },
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=44",
              "$$hashKey":"object:38102"
            },
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=45",
              "$$hashKey":"object:38103"
            },
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=46",
              "$$hashKey":"object:38104"
            }
          ],
          "interpreterSettingId":"spark"
        }
      }
    },
    {
      "text":"%pyspark\n\ninteractions_labeled_df.select(\"label\", \"protocol_type\", \"dst_bytes\").groupBy(\"label\", \"protocol_type\", interactions_labeled_df.dst_bytes==0).count().show()",
      "user":"anonymous",
      "config":{
        "editorSetting":{
          "language":"python",
          "editOnDblClick":false,
          "completionKey":"TAB",
          "completionSupport":true
        },
        "colWidth":12,
        "editorMode":"ace/mode/python",
        "fontSize":9,
        "runOnSelectionChange":true,
        "title":false,
        "checkEmpty":true,
        "results":[
          {
            "graph":{
              "mode":"table",
              "height":300,
              "optionOpen":false,
              "keys":[

              ],
              "values":[

              ],
              "groups":[

              ],
              "scatter":{

              }
            }
          }
        ],
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "results":{
        "code":"SUCCESS",
        "msg":[
          {
            "type":"TEXT",
            "data":"+------+-------------+---------------+------+\n| label|protocol_type|(dst_bytes = 0)| count|\n+------+-------------+---------------+------+\n|normal|          udp|          false| 15583|\n|attack|          udp|          false|    11|\n|attack|          tcp|           true|110583|\n|normal|          tcp|          false| 67500|\n|attack|         icmp|           true|282314|\n|attack|          tcp|          false|  2669|\n|normal|          tcp|           true|  9313|\n|normal|          udp|           true|  3594|\n|normal|         icmp|           true|  1288|\n|attack|          udp|           true|  1166|\n+------+-------------+---------------+------+\n\n"
          }
        ]
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"20151020-200116_1068349697",
      "id":"20151020-200116_1068349697",
      "dateCreated":"2019-11-04T14:21:41+0000",
      "status":"FINISHED",
      "$$hashKey":"object:28971",
      "runtimeInfos":{
        "jobUrl":{
          "propertyName":"jobUrl",
          "label":"SPARK JOB",
          "tooltip":"View in Spark web UI",
          "group":"spark",
          "values":[
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=47",
              "$$hashKey":"object:38237"
            },
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=48",
              "$$hashKey":"object:38238"
            },
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=49",
              "$$hashKey":"object:38239"
            },
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=50",
              "$$hashKey":"object:38240"
            },
            {
              "jobUrl":"http://192.168.10.14:4040/jobs/job?id=51",
              "$$hashKey":"object:38241"
            }
          ],
          "interpreterSettingId":"spark"
        }
      }
    },
    {
      "user":"anonymous",
      "dateUpdated":"2019-11-04T12:31:27+0000",
      "config":{
        "editorSetting":{
          "language":"scala",
          "editOnDblClick":false,
          "completionKey":"TAB",
          "completionSupport":true
        },
        "colWidth":12,
        "editorMode":"ace/mode/scala",
        "fontSize":9,
        "results":{

        },
        "graph":{
          "mode":"table",
          "height":300,
          "optionOpen":false,
          "keys":[

          ],
          "values":[

          ],
          "groups":[

          ],
          "scatter":{

          }
        },
        "enabled":true
      },
      "settings":{
        "params":{

        },
        "forms":{

        }
      },
      "apps":[

      ],
      "progressUpdateIntervalMs":500,
      "jobName":"paragraph_1572870687307_-1684068712",
      "id":"20151020-200231_820336316",
      "dateCreated":"2019-11-04T12:31:27+0000",
      "status":"READY",
      "$$hashKey":"object:28972"
    }
  ],
  "name":"Spark RDD Demo",
  "id":"2ESBKWTE3",
  "defaultInterpreterGroup":"spark",
  "version":"0.9.0-SNAPSHOT",
  "permissions":{

  },
  "noteParams":{

  },
  "noteForms":{

  },
  "angularObjects":{

  },
  "config":{
    "isZeppelinNotebookCronEnable":false,
    "looknfeel":"default",
    "personalizedMode":"false"
  },
  "info":{

  },
  "path":"/Spark RDD Demo"
}